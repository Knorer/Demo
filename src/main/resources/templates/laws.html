<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>

    <!--360 browser -->
    <meta name="renderer" content="webkit">
    <meta name="author" content="wos">
    <!-- Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="./images/i/app.png">
    <!--Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
    <link rel="apple-touch-icon-precomposed" href="./images/i/app.png">
    <!--Win8 or 10 -->
    <meta name="msapplication-TileImage" content="./images/i/app.png">
    <meta name="msapplication-TileColor" content="#e1652f">

    <link rel="icon" type="image/png" href="./images/i/favicon.png">
    <link rel="stylesheet" href="./css/amazeui.css">
    <link rel="stylesheet" href="./css/public.css">

    <!-- alert box
    <link rel="stylesheet" type="text/css" href="./css/xcConfirm.css">
    -->
    <script src="./js/jquery-1.9.1.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/xcConfirm.js" type="text/javascript" charset="utf-8"></script>


    <!--[if (gte IE 9)|!(IE)]
    <script src="./js/jquery.min.js"></script>
    <!--<![endif]-->
    <!--[if lte IE 8 ]>
    <!--
    <script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
    -->
    <script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
    <script src="./js/amazeui.ie8polyfill.min.js"></script>
    <![endif]-->
    <script src="./js/amazeui.min.js"></script>
    <script src="./js/public.js"></script>
</head>
<body>

<header class="am-topbar am-topbar-fixed-top wos-header">
    <div class="am-container">
        <h1 class="am-topbar-brand">
            <a href="#"><img src="./images/LOGO1.png" alt=""></a>
        </h1>


    </div>
</header>

<!--banner-->
<div class="banner">
    <div class="am-g am-container padding-none">
        <div class="am-u-sm-12 am-u-md-12 am-u-lg-8 padding-none">
            <div data-am-widget="slider" class="am-slider am-slider-c1" data-am-slider='{"directionNav":false}' >
                <ul class="am-slides">
                    <li>
                        <img src="Temp-images/tad3.png">

                    </li>
                    <li>
                        <img src="Temp-images/tad3.png">

                    </li>
                    <li>
                        <img src="Temp-images/tad3.png">

                    </li>
                </ul>
            </div>

        </div>
    </div>
</div>

<div class="am-g am-container padding-none">
    <div class="am-u-sm-12 am-u-md-12 am-u-lg-8 ">
        <div data-am-widget="titlebar" class="am-titlebar am-titlebar-default" >
            <h2 class="am-titlebar-title ">
                劳动类法律咨询
            </h2>
        </div>
        <div id="baoming" style="padding: unset">
            <form class="am-form" id="data-form" name="data-form">
                <fieldset>
                    <div class="am-form-group">
                        <label for="client_name">真实姓名</label>
                        <input type="text" class="" id="client_name" name="client_name" >
                    </div>
                    <div class="am-form-group">
                        <label for="company_name">所属单位名称</label>
                        <input type="text" class="" id="company_name" name="company_name"  placeholder="广州港集团公司下属">
                    </div>
                    <div class="am-form-group">
                        <label for="phone">联系电话</label>
                        <input type="text" class="" id="phone" name="phone" >
                        <input type="text" class="" id="code" name="code" style="width: 50%;margin-top: 5px;display: inline" placeholder="请输入手机验证码">
                            <input type="button" class="am-btn am-btn-default" id="codebutt" name="codebutt" style="width:146px;color: #fff;border-color: #e1652f;background-color: #e1652f;margin-top: 5px;display: inline" onclick="getMsgNum(this)" value="获取手机验证码">

                    </div>
                    <div class="am-form-group">
                        <label for="email">联系邮箱</label>
                        <input type="text" class="" id="email" name="email" placeholder="目前功能限制，请留下您的有效邮箱" >
                    </div>
                    <div class="am-form-group">
                        <label for="status">主题内容</label>
                        <input type="text" class="" id="status" name="status" placeholder="20个字以内的主题" maxlength="20">
                    </div>
                    <div class="am-form-group">
                        <label for="question">详细咨询内容</label>
                        <textarea class="" rows="5" id="question" name="question" placeholder="简述您想咨询的内容"></textarea>
                    </div>
                    <p style="text-align:center;">
                        <button type="submit" class="am-btn am-btn-default" id="butt" name="butt" style="width:200px;color: #fff;border-color: #e1652f;background-color: #e1652f;">提交</button>
                    </p>
                </fieldset>
            </form>
        </div>
    </div>
</div>
<div data-am-widget="gotop" class="am-gotop am-gotop-fixed" >
    <a href="#top" title="回到顶部">
        <span class="am-gotop-title">回到顶部</span>
        <i class="am-gotop-icon am-icon-chevron-up"></i>
    </a>
</div>
<footer>
</footer>
</body>
<script type="text/javascript">
    var messageData;
    var wait = 120;
    var tele;
    //阻止form的submit事件
    $(document).ready(function () {
        $("#data-form").submit(function (e) {
            e.preventDefault();
        });
    });
    // })
    function getMsgNum(that) {
        var phone = $("#phone").val().trim();

        var myreg=/^[1][3,4,5,7,8][0-9]{9}$/;
        if(phone===""){
            alert("请输入您的联系电话");
            return;
        }
        if(!myreg.test(phone)){
            alert("请输入正确的手机号码");
            return;
        }
        setButtonStatus(that);
        $.ajax({
            type:"POST",
            dataType:"json",
            url:"../lawsMessage/sendText",
            data:{
                phone : phone
            },
            success:function (result) {
                tele = phone;
                messageData = result;
                console.log(messageData)
            },
            error:function(XMLHttpRequest,textStatus,errorThrown) {
                console.log(XMLHttpRequest.status);
                console.log(XMLHttpRequest.readyState);
                console.log(textStatus);
            }
        })
    }
    function setButtonStatus(that) {
        if(wait == 0){
            that.removeAttribute("disabled");
            wait = 60;
        }else {
            that.setAttribute("disabled",true);
            that.value = wait+"秒后重发";
            wait --;
            setTimeout(function () {
                setButtonStatus(that)
            },1000)
        }
    }

    $(function () {
        $("#butt").click(function () {
            var client_name = $("#client_name").val().trim();
            var company_name = $("#company_name").val().trim();
            var question = $("#question").val().trim();
            var status = $("#status").val().trim();
            var code = $("#code").val().trim();
            var email = $("#email").val().trim();
            var confirma = confirm("提交情况属实，并愿意承担相应责任");
            if(client_name === ""){
                alert("请输入姓名");
                return;
            }
            if(status ===""){
                alert("请输入您咨询的主题内容");
                return;
            }
            if(company_name === ""){
                alert("请输入公司名");
                return;
            }
            if(email===""){
                alert("请输入您的真实邮箱");
                return;
            }
            if(question===""){
                alert("请输入您的咨询内容");
                return;
            }
            console.log("here");
            if(confirma===true){
                if(messageData == code){
                    $.ajax({
                        type:"POST",
                        dataType:"json",
                        url:"../lawsMessage/addLawsMessage",
                        data:{
                            client_name : client_name,
                            company_name : company_name,
                            phone : tele,
                            question : question,
                            status:status,
                            email:email
                        },
                        success: function (result) {
                            window.location.href="laws_success.html";
                        },
                        error:function(XMLHttpRequest,textStatus,errorThrown) {
                            console.log(XMLHttpRequest.status);
                            console.log(XMLHttpRequest.readyState);
                            console.log(textStatus);
                        }
                    });
                }else{
                    alert("验证码错误");
                }
            }else {
                return;
            }
    })
    })


</script>
</html>